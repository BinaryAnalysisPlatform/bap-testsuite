set test "propagate taint"
set regs {ZF A0 R1}
set bir_attrs {tainted-reg tainted-regs visited}

set opts "-d --propagate-taint"
foreach reg $regs {lappend opts "--taint-reg=$reg"}
foreach attr $bir_attrs {lappend opts "--print-bir-attr=$attr"}

foreach attr $bir_attrs {
    foreach-binary {file *} "bap $opts" {
        ".$attr" {close; wait; pass "$test $attr in $file"}
        default  {close; wait; fail "$test $attr in $file"}
    }
}
